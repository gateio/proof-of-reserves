- release_tracks: [GA]

  help_text:
    brief: Create a new Router appliance spoke.
    description: Create a new [Router appliance spoke](https://cloud.google.com/network-connectivity/docs/network-connectivity-center/how-to/working-with-hubs-spokes#create-ra-spoke).
    examples: |
      To create a spoke in region ``us-central1'' that uses data transfer and has
      two router appliance instances, run:

        $ {command} my-spoke --hub="https://www.googleapis.com/networkconnectivity/v1/projects/my-project/locations/global/hubs/my-hub" --region=us-central1 --router-appliance=instance=https://www.googleapis.com/compute/v1/projects/my-project/zones/us-central1-a/instances/vm1,ip=10.10.0.1 --router-appliance=instance=https://www.googleapis.com/compute/v1/projects/my-project/zones/us-central1-a/instances/vm2,ip=10.10.0.2 --site-to-site-data-transfer

  arguments:
    resource:
      spec: !REF googlecloudsdk.command_lib.network_connectivity.resources:spoke
      help_text: Name of the spoke to be created.
    params:
    - arg_name: hub
      required: true
      api_field: spoke.hub
      help_text: Hub that the spoke will attach to. The hub must already exist.
    - arg_name: description
      api_field: spoke.description
      help_text: Description of the spoke to create.
    - arg_name: router-appliance
      required: true
      api_field: spoke.linkedRouterApplianceInstances.instances
      type:
        arg_dict:
          flatten: false
          spec:
          - api_field: virtualMachine
            arg_name: instance
            type: str
          - api_field: ipAddress
            arg_name: ip
            type: str
      help_text: |
        Router appliance instance(s) that the spoke provides connectivity to. The resources must already exist.

        For example, use `--router-appliance=instance=ins_uri_1,ip=10.10.0.1` to add a single router appliance instance,
        or `--router-appliance=instance=ins_uri_1,ip=10.10.0.1 --router-appliance=instance=ins_uri_2,ip=10.10.0.2 ...`
        to add multiple instances.
    - arg_name: site-to-site-data-transfer
      api_field: spoke.linkedRouterApplianceInstances.siteToSiteDataTransfer
      help_text: |
        Whether to enable site-to-site data transfer for this spoke. Data transfer is available only
        in [supported locations](https://cloud.google.com/network-connectivity/docs/network-connectivity-center/concepts/locations).
    labels:
      api_field: spoke.labels

  async:
    collection: networkconnectivity.projects.locations.operations

  request: &request
    api_version: v1
    method: create
    collection: networkconnectivity.projects.locations.spokes
